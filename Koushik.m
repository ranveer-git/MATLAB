a=zeros(25)
cfe=0.6;
cinner=0.6;
e=0.01;
kh=4.5;
kb=0.07;
kucb=100;
kslide=(16);
krev=1.6;
kbcb1=600;
koffcbm=(0.0003);
koffcd=(0.0003);
koncbm=(0.019);
koncd=(0.001);
kon_cbm=1.9;
kon_cd=0.1;
a(1,1)=-1*(koffcbm);
a(1,2)= (koncbm*cinner);
a(2,1)= koffcbm;
a(2,2)=((-koncbm)*(cfe))+((-koncd)*(cfe))+((-koncbm)*(cinner));
a(2,3)= koffcbm;
a(2,4)= koffcd;
a(3,2)= koncbm*cfe;
a(3,3)=(-koffcbm-kon_cd);
a(3,5)= koffcd;
a(4,2)=(koncd*cfe);
a(4,4)= (-kslide)+(-koffcd)+(-kon_cbm);
a(4,5)= koffcbm;
a(4,6)=krev;
a(5,3)= kon_cd;
a(5,4)=kon_cbm;
a(5,5)= (-kslide)+(-koffcd)+(-koffcbm);
a(5,7)= krev;
a(6,4)= kslide ;
a(6,6)=(-krev)+(-kslide)+(-kon_cbm);
a(6,7)=koffcbm;
a(6,8)=krev;
a(7,5)= kslide;
a(7,6)=kon_cbm;
a(7,7)=(-kslide)+(-krev)+(-koffcbm);
a(7,9)=krev;
a(8,6)= kslide ;
a(8,8)=(-kslide)+(-krev)+(-kon_cbm);
a(8,9)=koffcbm;
a(8,10)=krev;
a(9,7)=kslide;
a(9,8)=kon_cbm;
a(9,9)=(-kslide)+(-krev)+(-koffcbm);
a(9,11)= krev;
a(10,8)=kslide ;
a(10,10)=(-krev)+(-kslide)+(-kon_cbm);
a(10,11)=koffcbm;
a(10,12)=krev;
a(11,9)=kslide;
a(11,10)=kon_cbm ;
a(11,11)=(-kslide)+(-krev)+(-koffcbm);
a(11,13)=krev;
a(12,10)=kslide;
a(12,12)=(-kslide)+(-krev)+(-kon_cbm);
a(12,13)=koffcbm;
a(12,14)=krev;
a(13,11)=kslide;
a(13,12)=kon_cbm;
a(13,13)=(-kslide)+(-krev)+(-koffcbm);
a(13,15)=krev;
a(14,12)=kslide;
a(14,14)=(-kslide)+(-krev)+(-kon_cbm);
a(14,15)=koffcbm;
a(14,16)=krev;
a(15,13)=kslide;
a(15,14)=kon_cbm;
a(15,15)=(-kslide)+(-krev)+(-koffcbm);
a(15,17)=krev;
a(16,14)=kslide;
a(16,16)=(-kslide)+(-krev)+(-kon_cbm);
a(16,17)=koffcbm;
a(16,18)=krev;
a(17,15)=kslide;
a(17,16)=kon_cbm;
a(17,17)=(-kslide)+(-krev)+(-koffcbm);
a(17,19)=krev;
a(18,16)=kslide;
a(18,22)=krev;
a(18,19)=koffcbm ;
a(18,18)=(-kslide)+(-krev)+(-kon_cbm)+(-kbcb1);
a(18,20)= kucb;
a(19,17)=kslide;
a(19,23)=krev;
a(19,18)= kon_cbm;
a(19,21)=kucb;
a(19,19)=(-kslide)+(-krev)+(-koffcbm)+(-kbcb1);
a(20,18)=kbcb1;
a(20,24)=kh;
a(20,21)=koffcbm;
a(20,20)=(-kucb)+(-kb)+(-kon_cbm);
a(21,19)=kbcb1;
a(21,25)=kh;
a(21,20)=kon_cbm;
a(21,21)=(-kucb)+(-kb)-(koffcbm);
a(22,18)=kslide;
a(22,24)= krev;
a(22,23)=koffcbm;
a(22,22)=(-kslide)+(-krev)+(-kon_cbm);
a(23,19)=kslide ;
a(23,25)=krev;
a(23,22)=kon_cbm;
a(23,23)=(-krev)+(-kslide)+(-koffcbm);
a(24,22)=kslide;
a(24,25)=koffcbm;
a(24,20)=kb;
a(24,24)= (-krev)+(-kh)+(-kon_cbm);
a(25,23)=kslide;
a(25,24)=kon_cbm;
a(25,21)=kb;
a(25,25)= -krev-kh-koffcbm;
I=eye(25);
[f,g]=eig(a,I);
r=diag(g);
x0=zeros(25,1);
x0(2)=10^-3;
c=f\x0

x=zeros(25,1);
syms t x
 x=f*(c.*exp(r*t));
h=10;
ts=5000;

for i=0:h:ts
x1=vpa(subs(x(1,1),t,i));
     x2=vpa(subs(x(2,1),t,i));
Q((i/h)+1)=1-((x1+x2)/0.001);
end
time=0:h:ts;
hold on
plot(time,Q)
